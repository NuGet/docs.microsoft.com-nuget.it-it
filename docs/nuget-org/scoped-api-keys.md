---
title: Chiavi API con ambito
description: Assumere il controllo delle chiavi API da usare per eseguire il push dei pacchetti
author: mikejo5000
ms.author: mikejo
ms.date: 06/04/2019
ms.topic: conceptual
ms.openlocfilehash: 12d12d5294a474c4d3e4f5d3cad468bb515d21d5
ms.sourcegitcommit: 2b50c450cca521681a384aa466ab666679a40213
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/07/2020
ms.locfileid: "67426946"
---
# <a name="scoped-api-keys"></a><span data-ttu-id="729f4-103">Chiavi API con ambito</span><span class="sxs-lookup"><span data-stu-id="729f4-103">Scoped API keys</span></span>

<span data-ttu-id="729f4-104">Per fare di NuGet un ambiente più sicuro per la distribuzione dei pacchetti, è possibile assumere il controllo delle chiavi API tramite l'aggiunta di ambiti.</span><span class="sxs-lookup"><span data-stu-id="729f4-104">To make NuGet a more secure environment for package distribution, you can take control of the API keys by adding scopes.</span></span>

<span data-ttu-id="729f4-105">La possibilità di fornire l'ambito alle chiavi API garantisce un maggior controllo sulle API.</span><span class="sxs-lookup"><span data-stu-id="729f4-105">The ability to provide scope to your API keys give you better control on your APIs.</span></span> <span data-ttu-id="729f4-106">È possibile:</span><span class="sxs-lookup"><span data-stu-id="729f4-106">You can:</span></span>

- <span data-ttu-id="729f4-107">Creare più chiavi API con ambito che possono essere usate per diversi pacchetti con date di scadenza variabili.</span><span class="sxs-lookup"><span data-stu-id="729f4-107">Create multiple scoped API keys that can be used for different packages with varying expiration timeframes.</span></span>
- <span data-ttu-id="729f4-108">Ottenere le chiavi API in modo sicuro.</span><span class="sxs-lookup"><span data-stu-id="729f4-108">Obtain API keys securely.</span></span>
- <span data-ttu-id="729f4-109">Modificare le chiavi API esistenti per cambiare l'applicabilità di pacchetto.</span><span class="sxs-lookup"><span data-stu-id="729f4-109">Edit existing API keys to change package applicability.</span></span>
- <span data-ttu-id="729f4-110">Aggiornare o eliminare le chiavi API esistenti senza intralciare le operazioni che usano altre chiavi.</span><span class="sxs-lookup"><span data-stu-id="729f4-110">Refresh or delete existing API keys without hampering operations using other keys.</span></span>

## <a name="why-do-we-support-scoped-api-keys"></a><span data-ttu-id="729f4-111">Perché sono supportate le chiavi API con ambito?</span><span class="sxs-lookup"><span data-stu-id="729f4-111">Why do we support scoped API keys?</span></span>

<span data-ttu-id="729f4-112">Gli ambiti per le chiavi API sono supportati per rendere disponibili autorizzazioni più dettagliate.</span><span class="sxs-lookup"><span data-stu-id="729f4-112">We support scopes for API keys to allow you to have more fine-grained permissions.</span></span> <span data-ttu-id="729f4-113">In precedenza NuGet offriva un'unica chiave API per un account, e tale approccio presentava diversi inconvenienti:</span><span class="sxs-lookup"><span data-stu-id="729f4-113">Previously, NuGet offered a single API key for an account, and that approach had several drawbacks:</span></span>

- <span data-ttu-id="729f4-114">**Una sola chiave API per controllare tutti i pacchetti**.</span><span class="sxs-lookup"><span data-stu-id="729f4-114">**One API key to control all packages**.</span></span> <span data-ttu-id="729f4-115">Con una sola chiave API per la gestione di tutti i pacchetti, è difficile condividere in modo sicuro la chiave quando più sviluppatori lavorano su pacchetti diversi e condividono un account editore.</span><span class="sxs-lookup"><span data-stu-id="729f4-115">With a single API key that is used to manage all packages, it is difficult to securely share the key when multiple developers are involved with different packages, and when they share a publisher account.</span></span>
- <span data-ttu-id="729f4-116">**Tutte le autorizzazioni o nessuna autorizzazione**.</span><span class="sxs-lookup"><span data-stu-id="729f4-116">**All permissions or none**.</span></span> <span data-ttu-id="729f4-117">Chiunque abbia accesso alla chiave API dispone di tutte le autorizzazioni per i pacchetti (pubblicazione, push e rimozione dall'elenco).</span><span class="sxs-lookup"><span data-stu-id="729f4-117">Anyone with access to the API key has all permissions (publish, push and un-list) on the packages.</span></span> <span data-ttu-id="729f4-118">In molti casi questa situazione non è ottimale in un ambiente con più team.</span><span class="sxs-lookup"><span data-stu-id="729f4-118">This is often not desirable in environment with multiple teams.</span></span>
- <span data-ttu-id="729f4-119">**Singolo punto di errore**.</span><span class="sxs-lookup"><span data-stu-id="729f4-119">**Single point of failure**.</span></span> <span data-ttu-id="729f4-120">Un'unica chiave API significa anche un singolo punto di guasto.</span><span class="sxs-lookup"><span data-stu-id="729f4-120">A single API key also means a single point of failure.</span></span> <span data-ttu-id="729f4-121">Se la chiave viene compromessa, tutti i pacchetti associati all'account potrebbero risultare compromessi.</span><span class="sxs-lookup"><span data-stu-id="729f4-121">If the key is compromised, all packages associated with the account could potentially be compromised.</span></span> <span data-ttu-id="729f4-122">L'aggiornamento della chiave API è l'unico modo per risolvere il problema ed evitare un'interruzione del flusso di lavoro CI/CD.</span><span class="sxs-lookup"><span data-stu-id="729f4-122">Refreshing the API key is the only way to plug the leak and avoid an interruption to your CI/CD workflow.</span></span> <span data-ttu-id="729f4-123">Possono anche esistere casi in cui si vuole revocare l'accesso alla chiave API per un utente (ad esempio quando un dipendente lascia l'organizzazione).</span><span class="sxs-lookup"><span data-stu-id="729f4-123">In addition, there may be cases when you want to revoke access to the API key for an individual (for example, when an employee leaves the organization).</span></span> <span data-ttu-id="729f4-124">Al momento non esiste un metodo ben definito per gestire questa situazione.</span><span class="sxs-lookup"><span data-stu-id="729f4-124">There isn’t a clean way to handle this today.</span></span>

<span data-ttu-id="729f4-125">Con le chiavi API con ambito si tenta di risolvere questi problemi, assicurandosi nel contempo che nessuno dei flussi di lavoro esistenti interrompa l'esecuzione.</span><span class="sxs-lookup"><span data-stu-id="729f4-125">With scoped API keys, we try to address these problems while making sure that none of the existing workflows break.</span></span>

## <a name="acquire-an-api-key"></a><span data-ttu-id="729f4-126">Acquisire una chiave API</span><span class="sxs-lookup"><span data-stu-id="729f4-126">Acquire an API key</span></span>

[!INCLUDE [publish-api-key](../quickstart/includes/publish-api-key.md)]

## <a name="create-scoped-api-keys"></a><span data-ttu-id="729f4-127">Creare chiavi API con ambito</span><span class="sxs-lookup"><span data-stu-id="729f4-127">Create scoped API keys</span></span>

<span data-ttu-id="729f4-128">È possibile creare più chiavi API in base alle esigenze.</span><span class="sxs-lookup"><span data-stu-id="729f4-128">You can create multiple API keys based on your requirements.</span></span> <span data-ttu-id="729f4-129">Una chiave API può essere applicata a uno o più pacchetti, avere ambiti diversi che concedono privilegi specifici ed essere associata a una data di scadenza specifica.</span><span class="sxs-lookup"><span data-stu-id="729f4-129">An API key can apply to one or more packages, have varying scopes that grant specific privileges, and have an expiration date associated with it.</span></span>

<span data-ttu-id="729f4-130">Nell'esempio seguente la chiave API con nome `Contoso service CI` può essere usata per eseguire il push di pacchetti per pacchetti `Contoso.Service` specifici ed è valida per 365 giorni.</span><span class="sxs-lookup"><span data-stu-id="729f4-130">In the following example, you have an API key named `Contoso service CI` that can be used to push packages for specific `Contoso.Service` packages, and is valid for 365 days.</span></span> <span data-ttu-id="729f4-131">Si tratta di uno scenario tipico in cui diversi team all'interno della stessa organizzazione lavorano su pacchetti diversi e i membri del team vengono dotati della chiave che concede loro privilegi solo per il pacchetto su cui stanno lavorando.</span><span class="sxs-lookup"><span data-stu-id="729f4-131">This is a typical scenario where different teams within the same organization work on different packages, and the members of the team are provided the key that grants them privileges only for the package they are working on.</span></span> <span data-ttu-id="729f4-132">La scadenza viene usata come meccanismo per evitare la presenza di chiavi non aggiornate o dimenticate.</span><span class="sxs-lookup"><span data-stu-id="729f4-132">The expiration serves as a mechanism to prevent stale or forgotten keys.</span></span>

![Creare chiavi API](media/scoped-api-keys-create-new.png)

## <a name="use-glob-patterns"></a><span data-ttu-id="729f4-134">Usare i criteri GLOB</span><span class="sxs-lookup"><span data-stu-id="729f4-134">Use glob patterns</span></span>

<span data-ttu-id="729f4-135">Se si sta lavorando su più pacchetti e si ha un lungo elenco di pacchetti da gestire, è possibile scegliere di usare i criteri GLOB per selezionare più pacchetti contemporaneamente.</span><span class="sxs-lookup"><span data-stu-id="729f4-135">If you are working on multiple packages and have a large list of packages to manage, you can choose to use globbing patterns to select multiple packages together.</span></span> <span data-ttu-id="729f4-136">Se ad esempio si vuole concedere a una chiave ambiti specifici per tutti i pacchetti il cui ID inizia con `Fabrikam.Service`, è possibile eseguire questa operazione specificando `fabrikam.service.*` nella casella di testo del **criterio Glob**.</span><span class="sxs-lookup"><span data-stu-id="729f4-136">For example, if you wish to grant specific scopes to a key for all packages whose ID starts with `Fabrikam.Service`, you could do this by specifying `fabrikam.service.*` in the **Glob pattern** text box.</span></span>

![Creare chiavi API](media/scoped-api-keys-glob-pattern.png)

<span data-ttu-id="729f4-138">L'uso di criteri GLOB per determinare le autorizzazioni della chiave API è valido anche per i nuovi pacchetti corrispondenti al criterio GLOB.</span><span class="sxs-lookup"><span data-stu-id="729f4-138">Using glob patterns to determine API key permissions also applies to new packages matching the glob pattern.</span></span> <span data-ttu-id="729f4-139">Ad esempio, se si tenta di eseguire il push di un nuovo pacchetto denominato `Fabrikam.Service.Framework`, è possibile farlo con la chiave creata in precedenza, perché il pacchetto corrisponde al criterio GLOB `fabrikam.service.*`.</span><span class="sxs-lookup"><span data-stu-id="729f4-139">For example, if you try to push a new package named `Fabrikam.Service.Framework`, you can do that with the key created previously, since the package matches the glob pattern `fabrikam.service.*`.</span></span>

## <a name="obtain-api-keys-securely"></a><span data-ttu-id="729f4-140">Ottenere le chiavi API in modo sicuro</span><span class="sxs-lookup"><span data-stu-id="729f4-140">Obtain API keys securely</span></span>

<span data-ttu-id="729f4-141">Per la sicurezza, una chiave appena creata non viene mai visualizzata sullo schermo ed è disponibile unicamente tramite il pulsante **Copia**.</span><span class="sxs-lookup"><span data-stu-id="729f4-141">For security, a newly created key is never shown on the screen and is only available using the **Copy** button.</span></span> <span data-ttu-id="729f4-142">Analogamente la chiave non è accessibile dopo l'aggiornamento della pagina.</span><span class="sxs-lookup"><span data-stu-id="729f4-142">Similarly, the key is not accessible after the page is refreshed.</span></span>

![Creare chiavi API](media/scoped-api-keys-obtain-keys.png)

## <a name="edit-existing-api-keys"></a><span data-ttu-id="729f4-144">Modificare chiavi API esistenti</span><span class="sxs-lookup"><span data-stu-id="729f4-144">Edit existing API keys</span></span>

<span data-ttu-id="729f4-145">È anche possibile che si voglia aggiornare le autorizzazioni e gli ambiti per le chiavi senza modificare le chiavi stesse.</span><span class="sxs-lookup"><span data-stu-id="729f4-145">You may also want to update the key permissions and scopes without changing the key itself.</span></span> <span data-ttu-id="729f4-146">Se si ha una chiave con uno o più ambiti specifici per un singolo pacchetto, è possibile scegliere di applicare lo stesso ambito o gli stessi ambiti su uno o molti altri pacchetti.</span><span class="sxs-lookup"><span data-stu-id="729f4-146">If you have a key with specific scope(s) for a single package, you can choose to apply the same scope(s) on one or many other packages.</span></span>

![Creare chiavi API](media/scoped-api-keys-edit.png)

## <a name="refresh-or-delete-existing-api-keys"></a><span data-ttu-id="729f4-148">Aggiornare o eliminare chiavi API esistenti</span><span class="sxs-lookup"><span data-stu-id="729f4-148">Refresh or delete existing API keys</span></span>

<span data-ttu-id="729f4-149">Il proprietario dell'account può scegliere di aggiornare la chiave, nel qual caso l'autorizzazione (per i pacchetti), l'ambito e la scadenza rimangono invariati, ma viene emessa una nuova chiave e la chiave precedente diventa inutilizzabile.</span><span class="sxs-lookup"><span data-stu-id="729f4-149">The account owner can choose to refresh the key, in which case the permission (on packages), scope, and expiry remain the same, but a new key is issued making the old key unusable.</span></span> <span data-ttu-id="729f4-150">Questo è utile per la gestione delle chiavi non aggiornate o nei casi in cui esiste il rischio di perdita di chiavi API.</span><span class="sxs-lookup"><span data-stu-id="729f4-150">This is helpful in managing stale keys or where there is any potential for an API key leakage.</span></span>

![Creare chiavi API](media/scoped-api-keys-refresh.png)

<span data-ttu-id="729f4-152">È anche possibile scegliere di eliminare queste chiavi se non sono più necessarie.</span><span class="sxs-lookup"><span data-stu-id="729f4-152">You may also choose to delete these keys if they are not needed anymore.</span></span> <span data-ttu-id="729f4-153">Se si elimina una chiave, questa viene rimossa e diventa inutilizzabile.</span><span class="sxs-lookup"><span data-stu-id="729f4-153">Deleting a key removes the key and makes it unusable.</span></span>

## <a name="faqs"></a><span data-ttu-id="729f4-154">Domande frequenti</span><span class="sxs-lookup"><span data-stu-id="729f4-154">FAQs</span></span>

### <a name="what-happens-to-my-old-legacy-api-key"></a><span data-ttu-id="729f4-155">Che cosa accade alla chiave API precedente (legacy)?</span><span class="sxs-lookup"><span data-stu-id="729f4-155">What happens to my old (legacy) API key?</span></span>

<span data-ttu-id="729f4-156">La chiave API precedente (legacy) continua a funzionare e può funzionare fino a quando si vuole usarla.</span><span class="sxs-lookup"><span data-stu-id="729f4-156">Your old API key (legacy) continues to work and can work as long as you want it to work.</span></span> <span data-ttu-id="729f4-157">Tuttavia queste chiavi vengono ritirate se non sono state usate da più di 365 giorni per eseguire il push di un pacchetto.</span><span class="sxs-lookup"><span data-stu-id="729f4-157">However, these keys will be retired if they have not been used for more than 365 days to push a package.</span></span> <span data-ttu-id="729f4-158">Per altre informazioni, vedere il post di blog [Changes to expiring API keys](https://blog.nuget.org/20160825/Changes-to-Expiring-API-Keys.html) (Modifiche per le chiavi API in scadenza).</span><span class="sxs-lookup"><span data-stu-id="729f4-158">For more details, see the blog post [Changes to expiring API keys](https://blog.nuget.org/20160825/Changes-to-Expiring-API-Keys.html).</span></span> <span data-ttu-id="729f4-159">Questa chiave non può più essere aggiornata.</span><span class="sxs-lookup"><span data-stu-id="729f4-159">You can no longer refresh this key.</span></span> <span data-ttu-id="729f4-160">È necessario eliminare la chiave legacy e creare una nuova chiave con ambito.</span><span class="sxs-lookup"><span data-stu-id="729f4-160">You need to delete the legacy key and create a new scoped key instead.</span></span>

> [!NOTE]
> <span data-ttu-id="729f4-161">Questa chiave ha tutte le autorizzazioni per tutti i pacchetti e non scade mai.</span><span class="sxs-lookup"><span data-stu-id="729f4-161">This key has all permissions on all the packages and it never expires.</span></span> <span data-ttu-id="729f4-162">È consigliabile eliminare questa chiave e creare nuove chiavi dotate di autorizzazioni con ambito e scadenza definita.</span><span class="sxs-lookup"><span data-stu-id="729f4-162">You should consider deleting this key and creating new keys with scoped permissions and definite expiry.</span></span>

### <a name="how-many-api-keys-can-i-create"></a><span data-ttu-id="729f4-163">Quante chiavi API è possibile creare?</span><span class="sxs-lookup"><span data-stu-id="729f4-163">How many API keys can I create?</span></span>

<span data-ttu-id="729f4-164">Non c'è limite al numero di chiavi API che è possibile creare.</span><span class="sxs-lookup"><span data-stu-id="729f4-164">There is no limit on the number of API keys you can create.</span></span> <span data-ttu-id="729f4-165">Tuttavia è consigliabile mantenere un numero di chiavi gestibile, per non avere molte chiavi non aggiornate e non riuscire a controllare da chi e dove vengono usate.</span><span class="sxs-lookup"><span data-stu-id="729f4-165">However, we advise you to keep it to a manageable count so that you do not end up having many stale keys with no knowledge of where and who is using them.</span></span>

### <a name="can-i-delete-my-legacy-api-key-or-discontinue-using-now"></a><span data-ttu-id="729f4-166">È possibile eliminare la chiave API legacy o interromperne l'uso ora?</span><span class="sxs-lookup"><span data-stu-id="729f4-166">Can I delete my legacy API key or discontinue using now?</span></span>

<span data-ttu-id="729f4-167">Sì.</span><span class="sxs-lookup"><span data-stu-id="729f4-167">Yes.</span></span> <span data-ttu-id="729f4-168">È possibile, ed è probabilmente necessario, eliminare la chiave API legacy.</span><span class="sxs-lookup"><span data-stu-id="729f4-168">You can--and you probably should--delete your legacy API key.</span></span>

### <a name="can-i-get-back-my-api-key-that-i-deleted-by-mistake"></a><span data-ttu-id="729f4-169">È possibile riottenere una chiave API eliminata per errore?</span><span class="sxs-lookup"><span data-stu-id="729f4-169">Can I get back my API key that I deleted by mistake?</span></span>

<span data-ttu-id="729f4-170">No.</span><span class="sxs-lookup"><span data-stu-id="729f4-170">No.</span></span> <span data-ttu-id="729f4-171">Dopo aver eliminato una chiave, è solo possibile creare nuove chiavi.</span><span class="sxs-lookup"><span data-stu-id="729f4-171">Once deleted, you can only create new keys.</span></span> <span data-ttu-id="729f4-172">Non è possibile recuperare le chiavi eliminate accidentalmente.</span><span class="sxs-lookup"><span data-stu-id="729f4-172">There is no recovery possible for accidentally deleted keys.</span></span>

### <a name="does-the-old-api-key-continue-to-work-upon-api-key-refresh"></a><span data-ttu-id="729f4-173">La chiave API precedente continua a funzionare dopo l'aggiornamento della chiave API?</span><span class="sxs-lookup"><span data-stu-id="729f4-173">Does the old API key continue to work upon API key refresh?</span></span>

<span data-ttu-id="729f4-174">No.</span><span class="sxs-lookup"><span data-stu-id="729f4-174">No.</span></span> <span data-ttu-id="729f4-175">Quando si aggiorna una chiave, viene generata una nuova chiave con lo stesso ambito, la stessa autorizzazione e la stessa scadenza della chiave precedente.</span><span class="sxs-lookup"><span data-stu-id="729f4-175">Once you refresh a key, a new key gets generated that has the same scope, permission, and expiry as the old one.</span></span> <span data-ttu-id="729f4-176">La chiave precedente cessa di esistere.</span><span class="sxs-lookup"><span data-stu-id="729f4-176">The old key ceases to exist.</span></span>

### <a name="can-i-give-more-permissions-to-an-existing-api-key"></a><span data-ttu-id="729f4-177">È possibile concedere più autorizzazioni a una chiave API esistente?</span><span class="sxs-lookup"><span data-stu-id="729f4-177">Can I give more permissions to an existing API key?</span></span>

<span data-ttu-id="729f4-178">Non è possibile modificare l'ambito, ma è possibile modificare l'elenco dei pacchetti ai quali la chiave è applicabile.</span><span class="sxs-lookup"><span data-stu-id="729f4-178">You cannot modify the scope, but you can edit the package list it is applicable to.</span></span>

### <a name="how-do-i-know-if-any-of-my-keys-expired-or-are-getting-expired"></a><span data-ttu-id="729f4-179">Come si capisce se una delle proprie chiavi è scaduta o sta per scadere?</span><span class="sxs-lookup"><span data-stu-id="729f4-179">How do I know if any of my keys expired or are getting expired?</span></span>

<span data-ttu-id="729f4-180">Se una qualsiasi chiave scade viene visualizzato un messaggio di avviso nella parte superiore della pagina.</span><span class="sxs-lookup"><span data-stu-id="729f4-180">If any key expires, we will let you know through a warning message at the top of the page.</span></span> <span data-ttu-id="729f4-181">Viene anche inviato un avviso tramite posta elettronica al titolare dell'account dieci giorni prima della scadenza della chiave, per consentire l'adozione delle misure necessarie con il dovuto anticipo.</span><span class="sxs-lookup"><span data-stu-id="729f4-181">We also send a warning e-mail to the account holder ten days before the expiration of the key so that you can act on it well in advance.</span></span>