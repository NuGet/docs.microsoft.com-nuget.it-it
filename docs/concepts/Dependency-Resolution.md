---
title: Risoluzione delle dipendenze dei pacchetti NuGet
description: Dettagli del processo tramite cui le dipendenze di un pacchetto NuGet vengono risolte e installate in NuGet 2.x e NuGet 3.x+.
author: karann-msft
ms.author: karann
ms.date: 08/14/2017
ms.topic: conceptual
ms.openlocfilehash: d2294ef0acb9053e74543204ae6f68b9fbc6fb0a
ms.sourcegitcommit: 39f2ae79fbbc308e06acf67ee8e24cfcdb2c831b
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 11/05/2019
ms.locfileid: "73611064"
---
# <a name="how-nuget-resolves-package-dependencies"></a><span data-ttu-id="b4ae9-103">Risoluzione delle dipendenze dei pacchetti in NuGet</span><span class="sxs-lookup"><span data-stu-id="b4ae9-103">How NuGet resolves package dependencies</span></span>

<span data-ttu-id="b4ae9-104">Ogni volta che un pacchetto viene installato o reinstallato, compresa l'installazione nell'ambito di un processo di [ripristino](../consume-packages/package-restore.md), NuGet installa anche eventuali altri pacchetti da cui dipende questo primo pacchetto.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-104">Any time a package is installed or reinstalled, which includes being installed as part of a [restore](../consume-packages/package-restore.md) process, NuGet also installs any additional packages on which that first package depends.</span></span>

<span data-ttu-id="b4ae9-105">Tali dipendenze immediate potrebbero quindi avere anche dipendenze proprie, che possono continuare fino a una profondità arbitraria.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-105">Those immediate dependencies might then also have dependencies on their own, which can continue to an arbitrary depth.</span></span> <span data-ttu-id="b4ae9-106">Ciò produce un cosiddetto *grafico dipendenze*, che descrive le relazioni tra i pacchetti a tutti i livelli.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-106">This produces what's called a *dependency graph* that describes the relationships between packages at all levels.</span></span>

<span data-ttu-id="b4ae9-107">Quando più pacchetti hanno la stessa dipendenza, lo stesso ID di pacchetto può essere visualizzato nel grafico più volte, potenzialmente con limitazioni delle versioni diverse.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-107">When multiple packages have the same dependency, then the same package ID can appear in the graph multiple times, potentially with different version constraints.</span></span> <span data-ttu-id="b4ae9-108">Tuttavia, solo una versione di un determinato pacchetto può essere usata in un progetto, pertanto NuGet deve scegliere quale versione usare.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-108">However, only one version of a given package can be used in a project, so NuGet must choose which version is used.</span></span> <span data-ttu-id="b4ae9-109">Il processo esatto dipende dal formato di gestione dei pacchetti in uso.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-109">The exact process depends on the package management format being used.</span></span>

## <a name="dependency-resolution-with-packagereference"></a><span data-ttu-id="b4ae9-110">Risoluzione delle dipendenze con PackageReference</span><span class="sxs-lookup"><span data-stu-id="b4ae9-110">Dependency resolution with PackageReference</span></span>

<span data-ttu-id="b4ae9-111">Quando si installano pacchetti in progetti usando il formato PackageReference, NuGet aggiunge riferimenti a un grafico di pacchetto semplice nel file appropriato e risolve i conflitti in anticipo.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-111">When installing packages into projects using the PackageReference format, NuGet adds references to a flat package graph in the appropriate file and resolves conflicts ahead of time.</span></span> <span data-ttu-id="b4ae9-112">Questo processo è noto come *ripristino transitivo*.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-112">This process is referred to as *transitive restore*.</span></span> <span data-ttu-id="b4ae9-113">La reinstallazione o il ripristino dei pacchetti è quindi un processo di download dei pacchetti elencati nel grafico, che genera compilazioni più veloci e più prevedibili.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-113">Reinstalling or restoring packages is then a process of downloading the packages listed in the graph, resulting in faster and more predictable builds.</span></span> <span data-ttu-id="b4ae9-114">È anche possibile usufruire di versioni con caratteri jolly (mobili), ad esempio 2.8.\*, evitando chiamate costose e soggette a errori a `nuget update` nei computer client e nei server di compilazione.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-114">You can also take advantage of wildcard (floating) versions, such as 2.8.\*, avoiding expensive and error prone calls to `nuget update` on the client machines and build servers.</span></span>

<span data-ttu-id="b4ae9-115">Quando il processo di ripristino di NuGet viene eseguito prima di una compilazione, risolve prima le dipendenze in memoria, quindi scrive il grafico risultante in un file denominato `project.assets.json`.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-115">When the NuGet restore process runs prior to a build, it resolves dependencies first in memory, then writes the resulting graph to a file called `project.assets.json`.</span></span> <span data-ttu-id="b4ae9-116">Scrive anche le dipendenze risolte in un file di blocco denominato `packages.lock.json`, se la [funzionalità di file di blocco è abilitata](https://docs.microsoft.com/nuget/consume-packages/package-references-in-project-files#locking-dependencies).</span><span class="sxs-lookup"><span data-stu-id="b4ae9-116">It also writes the resolved dependencies to a lock file named `packages.lock.json`, if the [lock file functionality is enabled](https://docs.microsoft.com/nuget/consume-packages/package-references-in-project-files#locking-dependencies).</span></span>
<span data-ttu-id="b4ae9-117">Il file di asset si trova in `MSBuildProjectExtensionsPath`, che per impostazione predefinita corrisponde alla cartella "obj" del progetto.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-117">The assets file is located at `MSBuildProjectExtensionsPath`, which defaults to the project's 'obj' folder.</span></span> <span data-ttu-id="b4ae9-118">MSBuild legge quindi questo file e lo converte in un set di cartelle in cui sono disponibili riferimenti potenziali, aggiungendoli quindi all'albero del progetto in memoria.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-118">MSBuild then reads this file and translates it into a set of folders where potential references can be found, and then adds them to the project tree in memory.</span></span>

<span data-ttu-id="b4ae9-119">Il file `project.assets.json` è temporaneo e non deve essere aggiunto al controllo del codice sorgente.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-119">The `project.assets.json` file is temporary and should not be added to source control.</span></span> <span data-ttu-id="b4ae9-120">Viene elencato per impostazione predefinita in `.gitignore` e `.tfignore`.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-120">It's listed by default in both `.gitignore` and `.tfignore`.</span></span> <span data-ttu-id="b4ae9-121">Vedere [Pacchetti e controllo del codice sorgente](../consume-packages/packages-and-source-control.md).</span><span class="sxs-lookup"><span data-stu-id="b4ae9-121">See [Packages and source control](../consume-packages/packages-and-source-control.md).</span></span>

### <a name="dependency-resolution-rules"></a><span data-ttu-id="b4ae9-122">Regole per la risoluzione delle dipendenze</span><span class="sxs-lookup"><span data-stu-id="b4ae9-122">Dependency resolution rules</span></span>

<span data-ttu-id="b4ae9-123">Il ripristino transitivo applica quattro regole principali per risolvere le dipendenze: versione più bassa applicabile, versioni mobili, prevalenza della versione più vicina e dipendenze prossime.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-123">Transitive restore applies four main rules to resolve dependencies: lowest applicable version, floating versions, nearest-wins, and cousin dependencies.</span></span>

<a name="lowest-applicable-version"></a>

#### <a name="lowest-applicable-version"></a><span data-ttu-id="b4ae9-124">Versione più bassa applicabile</span><span class="sxs-lookup"><span data-stu-id="b4ae9-124">Lowest applicable version</span></span>

<span data-ttu-id="b4ae9-125">La regola della versione più bassa applicabile ripristina la versione più bassa possibile di un pacchetto come definito dalle relative dipendenze.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-125">The lowest applicable version rule restores the lowest possible version of a package as defined by its dependencies.</span></span> <span data-ttu-id="b4ae9-126">Si applica anche alle dipendenze per l'applicazione o la libreria di classi a meno che non siano dichiarate [mobili](#floating-versions).</span><span class="sxs-lookup"><span data-stu-id="b4ae9-126">It also applies to dependencies on the application or the class library unless declared as [floating](#floating-versions).</span></span>

<span data-ttu-id="b4ae9-127">Nella figura seguente, ad esempio, la versione beta 1.0 viene considerata inferiore alla versione 1.0, pertanto NuGet sceglie la versione 1.0:</span><span class="sxs-lookup"><span data-stu-id="b4ae9-127">In the following figure, for example, 1.0-beta is considered lower than 1.0 so NuGet chooses the 1.0 version:</span></span>

![Scelta della versione più bassa applicabile](media/projectJson-dependency-1.png)

<span data-ttu-id="b4ae9-129">Nella figura successiva la versione 2.1 non è disponibile nel feed ma dal momento che la limitazione per la versione è >=2.1, NuGet sceglie la versione più bassa successiva che riesce a trovare, in questo caso la versione 2.2:</span><span class="sxs-lookup"><span data-stu-id="b4ae9-129">In the next figure, version 2.1 is not available on the feed but because the version constraint is >= 2.1 NuGet picks the next lowest version it can find, in this case 2.2:</span></span>

![Scelta della versione più bassa successiva disponibile nel feed](media/projectJson-dependency-2.png)

<span data-ttu-id="b4ae9-131">Quando un'applicazione specifica un numero di versione esatto, ad esempio 1.2, che non è disponibile nel feed, NuGet genera un errore durante il tentativo di installare o ripristinare il pacchetto:</span><span class="sxs-lookup"><span data-stu-id="b4ae9-131">When an application specifies an exact version number, such as 1.2, that is not available on the feed, NuGet fails with an error when attempting to install or restore the package:</span></span>

![NuGet genera un errore quando non è disponibile un numero di versione esatto del pacchetto](media/projectJson-dependency-3.png)

<a name="floating-versions"></a>

#### <a name="floating-wildcard-versions"></a><span data-ttu-id="b4ae9-133">Versioni con caratteri jolly (mobili)</span><span class="sxs-lookup"><span data-stu-id="b4ae9-133">Floating (wildcard) versions</span></span>

<span data-ttu-id="b4ae9-134">Una versione della dipendenza con caratteri jolly o mobile viene specificata con il carattere jolly \*, ad esempio 6.0.\*.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-134">A floating or wildcard dependency version is specified with the \* wildcard, as with 6.0.\*.</span></span> <span data-ttu-id="b4ae9-135">La specifica di questa versione indica di "usare la versione 6.0.x più recente"; 4.\* vuol dire "usare la versione 4.x più recente".</span><span class="sxs-lookup"><span data-stu-id="b4ae9-135">This version specification says "use the latest 6.0.x version"; 4.\* means "use the latest 4.x version."</span></span> <span data-ttu-id="b4ae9-136">L'uso di caratteri jolly consente a un pacchetto della dipendenza di continuare a evolversi senza richiedere una modifica all'applicazione (o al pacchetto) che lo utilizza.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-136">Using a wildcard allows a dependency package to continue evolving without requiring a change to the consuming application (or package).</span></span>

<span data-ttu-id="b4ae9-137">Quando si usa un carattere jolly, NuGet risolve la versione più alta di un pacchetto che corrisponde al modello della versione, ad esempio 6.0.\* ottiene la versione più alta di un pacchetto che inizia con 6.0:</span><span class="sxs-lookup"><span data-stu-id="b4ae9-137">When using a wildcard, NuGet resolves the highest version of a package that matches the version pattern, for example 6.0.\* gets the highest version of a package that starts with 6.0:</span></span>

![Scelta della versione 6.0.1 quando è richiesta una versione mobile 6.0.\*](media/projectJson-dependency-4.png)

> [!Note]
> <span data-ttu-id="b4ae9-139">Per informazioni sul comportamento dei caratteri jolly e delle versioni non definitive, vedere [Controllo delle versioni dei pacchetti](package-versioning.md#version-ranges-and-wildcards).</span><span class="sxs-lookup"><span data-stu-id="b4ae9-139">For information on the behavior of wildcards and pre-release versions, see [Package versioning](package-versioning.md#version-ranges-and-wildcards).</span></span>


<a name="nearest-wins"></a>

#### <a name="nearest-wins"></a><span data-ttu-id="b4ae9-140">Prevalenza della versione più vicina</span><span class="sxs-lookup"><span data-stu-id="b4ae9-140">Nearest wins</span></span>

<span data-ttu-id="b4ae9-141">Quando il grafico di pacchetto per un'applicazione contiene versioni diverse dello stesso pacchetto, NuGet sceglie il pacchetto più vicino all'applicazione nel grafico e ignora tutti gli altri.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-141">When the package graph for an application contains different versions of the same package, NuGet chooses the package that's closest to the application in the graph and ignores all others.</span></span> <span data-ttu-id="b4ae9-142">Questo comportamento consente a un'applicazione di eseguire l'override di qualsiasi versione del pacchetto specifica nel grafico dipendenze.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-142">This behavior allows an application to override any particular package version in the dependency graph.</span></span>

<span data-ttu-id="b4ae9-143">Nell'esempio seguente l'applicazione dipende direttamente dal pacchetto B con una limitazione della versione di >=2.0.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-143">In the example below, the application depends directly on Package B with a version constraint of >=2.0.</span></span> <span data-ttu-id="b4ae9-144">L'applicazione dipende inoltre dal pacchetto A, che dipende a sua volta anche dal pacchetto B, ma con una limitazione di >=1.0.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-144">The application also depends on Package A which in turn also depends on Package B, but with a >=1.0 constraint.</span></span> <span data-ttu-id="b4ae9-145">Poiché la dipendenza dal pacchetto B 2.0 è più vicina all'applicazione nel grafico, viene usata tale versione:</span><span class="sxs-lookup"><span data-stu-id="b4ae9-145">Because the dependency on Package B 2.0 is nearer to the application in the graph, that version is used:</span></span>

![Applicazione che usa la regola di prevalenza della versione più vicina](media/projectJson-dependency-5.png)

>[!Warning]
> <span data-ttu-id="b4ae9-147">La regola di prevalenza della versione più vicina può comportare un downgrade della versione del pacchetto, interrompendo pertanto potenzialmente altre dipendenze nel grafico.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-147">The Nearest Wins rule can result in a downgrade of the package version, thus potentially breaking other dependencies in the graph.</span></span> <span data-ttu-id="b4ae9-148">Di conseguenza questa regola viene applicata con un avviso per informare l'utente.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-148">Hence this rule is applied with a warning to alert the user.</span></span>

<span data-ttu-id="b4ae9-149">Questa regola comporta inoltre una maggiore efficienza con un grafico dipendenze di grandi dimensioni (come quelli con i pacchetti BCL) poiché una volta che una dipendenza specificata viene ignorata, NuGet ignora anche tutte le dipendenze rimanenti in quel ramo del grafico.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-149">This rule also results in greater efficiency with a large dependency graph (such as those with the BCL packages) because once a given dependency is ignored, NuGet also ignores all remaining dependencies on that branch of the graph.</span></span> <span data-ttu-id="b4ae9-150">Nel diagramma seguente, ad esempio, dal momento che viene usato il pacchetto C 2.0, NuGet ignora qualsiasi ramo nel grafico che faccia riferimento a una versione precedente del pacchetto C:</span><span class="sxs-lookup"><span data-stu-id="b4ae9-150">In the diagram below, for example, because Package C 2.0 is used, NuGet ignores any branches in the graph that refer to an older version of Package C:</span></span>

![Quando NuGet ignora un pacchetto nel grafico, ignora l'intero ramo](media/projectJson-dependency-6.png)

<a name="cousin-dependencies"></a>

#### <a name="cousin-dependencies"></a><span data-ttu-id="b4ae9-152">Dipendenze prossime</span><span class="sxs-lookup"><span data-stu-id="b4ae9-152">Cousin dependencies</span></span>

<span data-ttu-id="b4ae9-153">Quando versioni diverse di un pacchetto vengono definite alla stessa distanza dall'applicazione nel grafico, NuGet usa la versione più bassa che soddisfa tutti i requisiti di versione (come con le regole della [versione più bassa applicabile](#lowest-applicable-version) e delle [versioni mobili](#floating-versions)).</span><span class="sxs-lookup"><span data-stu-id="b4ae9-153">When different package versions are referred to at the same distance in the graph from the application, NuGet uses the lowest version that satisfies all version requirements (as with the [lowest applicable version](#lowest-applicable-version) and [floating versions](#floating-versions) rules).</span></span> <span data-ttu-id="b4ae9-154">Nell'immagine seguente, ad esempio, la versione 2.0 del pacchetto B soddisfa l'altra limitazione >=1.0 e pertanto viene usata:</span><span class="sxs-lookup"><span data-stu-id="b4ae9-154">In the image below, for example, version 2.0 of Package B satisfies the other >=1.0 constraint, and is thus used:</span></span>

![Risoluzione delle dipendenze prossime tramite l'uso della versione più bassa che soddisfa tutte le limitazioni](media/projectJson-dependency-7.png)

<span data-ttu-id="b4ae9-156">In alcuni casi non è possibile soddisfare tutti i requisiti di versione.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-156">In some cases, it's not possible to meet all version requirements.</span></span> <span data-ttu-id="b4ae9-157">Come illustrato di seguito, se il pacchetto A richiede esattamente il pacchetto B 1.0 e il pacchetto C richiede il pacchetto B >=2.0, NuGet non riesce a risolvere le dipendenze e restituisce un errore.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-157">As shown below, if Package A requires exactly Package B 1.0 and Package C requires Package B >=2.0, then NuGet cannot resolve the dependencies and gives an error.</span></span>

![Dipendenze non risolvibili a causa di un requisito di versione esatto](media/projectJson-dependency-8.png)

<span data-ttu-id="b4ae9-159">In questi casi, il consumer di livello superiore (applicazione o pacchetto) deve aggiungere la propria dipendenza diretta dal pacchetto B, in modo che si applichi la regola della [prevalenza della versione più vicina](#nearest-wins).</span><span class="sxs-lookup"><span data-stu-id="b4ae9-159">In these situations, the top-level consumer (the application or package) should add its own direct dependency on Package B so that the [Nearest Wins](#nearest-wins) rule applies.</span></span>

## <a name="dependency-resolution-with-packagesconfig"></a><span data-ttu-id="b4ae9-160">Risoluzione delle dipendenze con packages.config</span><span class="sxs-lookup"><span data-stu-id="b4ae9-160">Dependency resolution with packages.config</span></span>

<span data-ttu-id="b4ae9-161">Con `packages.config`, le dipendenze di un progetto vengono scritte in `packages.config` sotto forma di elenco semplice.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-161">With `packages.config`, a project's dependencies are written to `packages.config` as a flat list.</span></span> <span data-ttu-id="b4ae9-162">Anche le eventuali dipendenze di questi pacchetti vengono scritte nello stesso elenco.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-162">Any dependencies of those packages are also written in the same list.</span></span> <span data-ttu-id="b4ae9-163">Quando i pacchetti vengono installati, NuGet può anche modificare il file `.csproj`, `app.config`, `web.config` e altri file singoli.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-163">When packages are installed, NuGet might also modify the `.csproj` file, `app.config`, `web.config`, and other individual files.</span></span>

<span data-ttu-id="b4ae9-164">Con `packages.config`, NuGet tenta di risolvere i conflitti di dipendenza durante l'installazione di ogni singolo pacchetto.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-164">With `packages.config`, NuGet attempts to resolve dependency conflicts during the installation of each individual package.</span></span> <span data-ttu-id="b4ae9-165">Ovvero, se il pacchetto A viene installato e dipende dal pacchetto B e il pacchetto B è già elencato in `packages.config` come dipendenza di un altro elemento, NuGet confronta le versioni del pacchetto B richieste e tenta di trovare una versione che soddisfi tutte le limitazioni delle versioni.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-165">That is, if Package A is being installed and depends on Package B, and Package B is already listed in `packages.config` as a dependency of something else, NuGet compares the versions of Package B being requested and attempts to find a version that satisfies all version constraints.</span></span> <span data-ttu-id="b4ae9-166">In particolare, NuGet seleziona la versione più bassa di *major.minor* che soddisfa le dipendenze.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-166">Specifically, NuGet selects the lower *major.minor* version that satisfies dependencies.</span></span>

<span data-ttu-id="b4ae9-167">Per impostazione predefinita, NuGet 2.8 cerca la versione di patch minima (vedere le [note sulla versione di NuGet 2.8](../release-notes/nuget-2.8.md#patch-resolution-for-dependencies)).</span><span class="sxs-lookup"><span data-stu-id="b4ae9-167">By default, NuGet 2.8 looks for the lowest patch version (see [NuGet 2.8 release notes](../release-notes/nuget-2.8.md#patch-resolution-for-dependencies)).</span></span> <span data-ttu-id="b4ae9-168">È possibile controllare questa impostazione tramite l'attributo `DependencyVersion` in `Nuget.Config` e l'opzione `-DependencyVersion` della riga di comando.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-168">You can control this setting through the `DependencyVersion` attribute in `Nuget.Config` and the `-DependencyVersion` switch on the command line.</span></span>  

<span data-ttu-id="b4ae9-169">Il processo `packages.config` per la risoluzione delle dipendenze diventa complicato per grafici delle dipendenze di dimensioni più elevate.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-169">The `packages.config` process for resolving dependencies gets complicated for larger dependency graphs.</span></span> <span data-ttu-id="b4ae9-170">Ogni nuova installazione del pacchetto richiede un attraversamento dell'intero grafico e genera probabilità di conflitti di versione.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-170">Each new package installation requires a traversal of the whole graph and raises the chance for version conflicts.</span></span> <span data-ttu-id="b4ae9-171">Quando si verifica un conflitto, l'installazione viene interrotta, lasciando il progetto in uno stato indeterminato, in particolare con potenziali modifiche al file di progetto stesso.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-171">When a conflict occurs, installation is stopped, leaving the project in an indeterminate state, especially with potential modifications to the project file itself.</span></span> <span data-ttu-id="b4ae9-172">Questo non è un problema quando si usano altri formati di gestione dei pacchetti.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-172">This is not an issue when using other package management formats.</span></span>

## <a name="managing-dependency-assets"></a><span data-ttu-id="b4ae9-173">Gestione degli asset delle dipendenze</span><span class="sxs-lookup"><span data-stu-id="b4ae9-173">Managing dependency assets</span></span>

<span data-ttu-id="b4ae9-174">Quando si usa il formato PackageReference, è possibile controllare quali asset dalle dipendenze vengono inseriti nel progetto di primo livello.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-174">When using the PackageReference format, you can control which assets from dependencies flow into the top-level project.</span></span> <span data-ttu-id="b4ae9-175">Per informazioni dettagliate, vedere [PackageReference](../consume-packages/package-references-in-project-files.md#controlling-dependency-assets).</span><span class="sxs-lookup"><span data-stu-id="b4ae9-175">For details, see [PackageReference](../consume-packages/package-references-in-project-files.md#controlling-dependency-assets).</span></span>

<span data-ttu-id="b4ae9-176">Quando il progetto di primo livello è un pacchetto, è anche possibile avere il controllo di questo flusso usando gli attributi `include` e `exclude` con le dipendenze elencate nel file `.nuspec`.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-176">When the top-level project is itself a package, you also have control over this flow by using the `include` and `exclude` attributes with dependencies listed in the `.nuspec` file.</span></span> <span data-ttu-id="b4ae9-177">Vedere la [sezione Dipendenze delle informazioni di riferimento sul file .nuspec](../reference/nuspec.md#dependencies).</span><span class="sxs-lookup"><span data-stu-id="b4ae9-177">See [.nuspec Reference - Dependencies](../reference/nuspec.md#dependencies).</span></span>

## <a name="excluding-references"></a><span data-ttu-id="b4ae9-178">Esclusione dei riferimenti</span><span class="sxs-lookup"><span data-stu-id="b4ae9-178">Excluding references</span></span>

<span data-ttu-id="b4ae9-179">Esistono scenari in cui agli assembly con lo stesso nome potrebbe essere fatto riferimento più volte in un progetto, generando errori in fase di progettazione e in fase di compilazione.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-179">There are scenarios in which assemblies with the same name might be referenced more than once in a project, producing design-time and build-time errors.</span></span> <span data-ttu-id="b4ae9-180">Si consideri un progetto che contiene una versione personalizzata di `C.dll` e che fa riferimento al pacchetto C contenente anche `C.dll`.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-180">Consider a project that contains a custom version of `C.dll`, and references Package C that also contains `C.dll`.</span></span> <span data-ttu-id="b4ae9-181">Al tempo stesso, il progetto dipende anche dal pacchetto B, che dipende anche dal pacchetto C e da `C.dll`.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-181">At the same time, the project also depends on Package B which also depends on Package C and `C.dll`.</span></span> <span data-ttu-id="b4ae9-182">Di conseguenza, NuGet non riesce a determinare quale `C.dll` usare, ma è possibile rimuovere semplicemente la dipendenza del progetto dal pacchetto C perché anche il pacchetto B dipende da esso.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-182">As a result, NuGet can't determine which `C.dll` to use, but you can't just remove the project's dependency on Package C because Package B also depends on it.</span></span>

<span data-ttu-id="b4ae9-183">Per risolvere questa situazione, è necessario fare riferimento direttamente al `C.dll` desiderato (o usare un altro pacchetto che faccia riferimento a quello giusto) e quindi aggiungere una dipendenza dal pacchetto C che escluda tutti i relativi asset.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-183">To resolve this, you must directly reference the `C.dll` you want (or use another package that references the right one), and then add a dependency on Package C that excludes all its assets.</span></span> <span data-ttu-id="b4ae9-184">Questa operazione viene eseguita come indicato di seguito a seconda del formato di gestione dei pacchetti in uso:</span><span class="sxs-lookup"><span data-stu-id="b4ae9-184">This is done as follows depending on the package management format in use:</span></span>

- <span data-ttu-id="b4ae9-185">[PackageReference](../consume-packages/package-references-in-project-files.md): aggiungere `ExcludeAssets="All"` nella dipendenza:</span><span class="sxs-lookup"><span data-stu-id="b4ae9-185">[PackageReference](../consume-packages/package-references-in-project-files.md): add `ExcludeAssets="All"` in the dependency:</span></span>

    ```xml
    <PackageReference Include="PackageC" Version="1.0.0" ExcludeAssets="All" />
    ```

- <span data-ttu-id="b4ae9-186">`packages.config`: rimuovere il riferimento al pacchetto C (PackageC) dal file `.csproj` in modo che faccia riferimento solo alla versione di `C.dll` desiderata.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-186">`packages.config`: remove the reference to PackageC from the `.csproj` file so that it references only the version of `C.dll` that you want.</span></span>
    
## <a name="dependency-updates-during-package-install"></a><span data-ttu-id="b4ae9-187">Aggiornamenti delle dipendenze durante l'installazione dei pacchetti</span><span class="sxs-lookup"><span data-stu-id="b4ae9-187">Dependency updates during package install</span></span> 

<span data-ttu-id="b4ae9-188">Se una versione della dipendenza è già soddisfatta, la dipendenza non viene aggiornata durante le altre installazioni del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-188">If a dependency version is already satisfied, the dependency isn't updated during other package installations.</span></span> <span data-ttu-id="b4ae9-189">Si consideri ad esempio il pacchetto A che dipende dal pacchetto B e specifica 1.0 per il numero di versione.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-189">For example, consider package A that depends on package B and specifies 1.0 for the version number.</span></span> <span data-ttu-id="b4ae9-190">Il repository di origine contiene le versioni 1.0, 1.1 e 1.2 del pacchetto B. Se il pacchetto A è installato in un progetto che contiene già la versione 1.0 del pacchetto B, il pacchetto B 1.0 rimane in uso perché soddisfa il vincolo di versione.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-190">The source repository contains versions 1.0, 1.1, and 1.2 of package B. If A is installed in a project that already contains B version 1.0, then B 1.0 remains in use because it satisfies the version constraint.</span></span> <span data-ttu-id="b4ae9-191">Tuttavia, se un pacchetto A richiede la versione 1.1 o versioni successive del pacchetto B, verrà installata la versione 1.2 del pacchetto B.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-191">However, if package A had requests version 1.1 or higher of B, then B 1.2 would be installed.</span></span> 

## <a name="resolving-incompatible-package-errors"></a><span data-ttu-id="b4ae9-192">Risoluzione degli errori dei pacchetti incompatibili</span><span class="sxs-lookup"><span data-stu-id="b4ae9-192">Resolving incompatible package errors</span></span>

<span data-ttu-id="b4ae9-193">Durante un'operazione di ripristino di un pacchetto, potrebbe essere visualizzato un errore analogo a "Uno o più pacchetti non sono compatibili..." o un avviso che un pacchetto "non è compatibile" con il framework di destinazione del progetto.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-193">During a package restore operation, you may see the error "One or more packages are not compatible..." or that a package "is not compatible" with the project's target framework.</span></span>

<span data-ttu-id="b4ae9-194">Questo errore si verifica quando uno o più dei pacchetti a cui si fa riferimento nel progetto non indicano che supportano il framework di destinazione del progetto, vale a dire il pacchetto non contiene una DLL appropriata nella relativa cartella `lib` per un framework di destinazione compatibile con il progetto</span><span class="sxs-lookup"><span data-stu-id="b4ae9-194">This error occurs when one or more of the packages referenced in your project do not indicate that they support the project's target framework; that is, the package does not contain a suitable DLL in its `lib` folder for a target framework that is compatible with the project.</span></span> <span data-ttu-id="b4ae9-195">(vedere [Framework di destinazione](../reference/target-frameworks.md) per un elenco).</span><span class="sxs-lookup"><span data-stu-id="b4ae9-195">(See [Target frameworks](../reference/target-frameworks.md) for a list.)</span></span> 

<span data-ttu-id="b4ae9-196">Ad esempio, se un progetto ha come destinazione `netstandard1.6` e si tenta di installare un pacchetto che contiene DLL solo nelle cartelle `lib\net20` e `\lib\net45`, vengono visualizzati messaggi simili al seguente per il pacchetto ed eventualmente i relativi dipendenti:</span><span class="sxs-lookup"><span data-stu-id="b4ae9-196">For example, if a project targets `netstandard1.6` and you attempt to install a package that contains DLLs in only the `lib\net20` and `\lib\net45` folders, then you see messages like the following for the package and possibly its dependents:</span></span>

```output
Restoring packages for myproject.csproj...
Package ContosoUtilities 2.1.2.3 is not compatible with netstandard1.6 (.NETStandard,Version=v1.6). Package ContosoUtilities 2.1.2.3 supports:
  - net20 (.NETFramework,Version=v2.0)
  - net45 (.NETFramework,Version=v4.5)
Package ContosoCore 0.86.0 is not compatible with netstandard1.6 (.NETStandard,Version=v1.6). Package ContosoCore 0.86.0 supports:
  - 11 (11,Version=v0.0)
  - net20 (.NETFramework,Version=v2.0)
  - sl3 (Silverlight,Version=v3.0)
  - sl4 (Silverlight,Version=v4.0)
One or more packages are incompatible with .NETStandard,Version=v1.6.
Package restore failed. Rolling back package changes for 'MyProject'.
```

<span data-ttu-id="b4ae9-197">Per risolvere le incompatibilità, eseguire una delle operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="b4ae9-197">To resolve incompatibilities, do one of the following:</span></span>

- <span data-ttu-id="b4ae9-198">Ridestinare il progetto per un framework supportato dai pacchetti da usare.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-198">Retarget your project to a framework that is supported by the packages you want to use.</span></span>
- <span data-ttu-id="b4ae9-199">Contattare l'autore dei pacchetti e collaborare per aggiungere il supporto per il framework scelto.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-199">Contact the author of the packages and work with them to add support for your chosen framework.</span></span> <span data-ttu-id="b4ae9-200">Nella pagina di presentazione di tutti i pacchetti su [nuget.org](https://www.nuget.org/) è incluso un collegamento **Contact Owners** (Contatta proprietari) a questo scopo.</span><span class="sxs-lookup"><span data-stu-id="b4ae9-200">Each package listing page on [nuget.org](https://www.nuget.org/) has a **Contact Owners** link for this purpose.</span></span>

